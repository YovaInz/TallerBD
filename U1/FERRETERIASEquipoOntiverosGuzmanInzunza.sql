CREATE DATABASE FERRETERIAS
GO
USE FERRETERIAS
GO
--Creacion de tablas
CREATE TABLE ZONAS(
ZONAID INT NOT NULL,
ZONANOMBRE NVARCHAR(50) NOT NULL,
ZONADESCRIPCION NVARCHAR(200) NULL
)
GO
CREATE TABLE MUNICIPIOS(
MUNID INT NOT NULL,
MUNNOMBRE NVARCHAR(50) NOT NULL,
LADA NCHAR(3) NULL
)
GO
CREATE TABLE COLONIAS(
COLID INT NOT NULL,
COLNOMBRE NVARCHAR(50) NOT NULL,
COLCP NCHAR(5) NULL,
MUNID INT NOT NULL
)
GO
CREATE TABLE FERRETERIAS(
FERRID INT NOT NULL,
FERRNOMBRE NVARCHAR(30) NOT NULL,
FERRDOMICILIO NVARCHAR(50) NOT NULL,
FERRTELEFONO NCHAR(10) NULL
)
GO
CREATE TABLE EMPLEADOS(
EMPID INT NOT NULL,
EMPNOMBRE NVARCHAR(50) NOT NULL,
EMPAPEPAT NVARCHAR(50) NOT NULL,
EMPAPEMAT NVARCHAR(50) NULL,
EMPDOMICILIO NVARCHAR(50) NOT NULL,
EMPTELEFONO NCHAR(10) NULL,
EMPCELULAR NCHAR(10) NULL,
EMPRFC NCHAR(13) NULL,
EMPCURP NCHAR(18) NULL,
EMPFECHAINGRESO DATETIME NOT NULL,
EMPFECHANACIMIENTO DATETIME NOT NULL,
ZONAID INT NOT NULL,
JEFEID INT NULL
)
GO
CREATE TABLE CLIENTES(
CTEID INT NOT NULL,
CTENOMBRE NVARCHAR(50) NOT NULL,
CTEAPEPAT NVARCHAR(50) NOT NULL,
CTEAPEMAT NVARCHAR(50) NULL,
CTEDOMICILIO NVARCHAR(50) NOT NULL,
CTETELEFONO NCHAR(10) NULL,
CTECELULAR NCHAR(10) NULL,
CTERFC NCHAR(13) NULL,
CTECURP NCHAR(18) NULL,
CTEFECHANACIMIENTO DATETIME NOT NULL,
CTESEXO NCHAR(1) NOT NULL,
COLID INT NOT NULL
)
GO
CREATE TABLE ARTICULOS(
ARTID INT NOT NULL,
ARTNOMBRE NVARCHAR(20) NOT NULL,
ARTDESCRIPCION NVARCHAR(200) NOT NULL,
ARTPRECIO NUMERIC(10,2) NOT NULL,
FAMID INT NOT NULL
)
GO
CREATE TABLE VENTAS(
FOLIO INT NOT NULL,
FECHA DATETIME NOT NULL,
FERRID INT NOT NULL,
CTEID INT NOT NULL,
EMPID INT NOT NULL
)
GO
CREATE TABLE DETALLE(
FOLIO INT NOT NULL,
ARTID INT NOT NULL,
CANTIDAD NUMERIC(7,2) NOT NULL,
PRECIO NUMERIC(10,2) NOT NULL
)
GO
CREATE TABLE FAMILIAS(
FAMID INT NOT NULL,
FAMNOMBRE NVARCHAR(30) NOT NULL,
FAMDESCRIPCION NVARCHAR(200) NOT NULL
)
GO
--LLAVES PRIMARIAS
ALTER TABLE ZONAS ADD CONSTRAINT pkZona PRIMARY KEY(ZONAID)
GO
ALTER TABLE EMPLEADOS ADD CONSTRAINT pkEmpleados PRIMARY KEY(EMPID)
GO
ALTER TABLE FAMILIAS ADD CONSTRAINT pkFamilias PRIMARY KEY(FAMID)
GO
ALTER TABLE ARTICULOS ADD CONSTRAINT pkArticulos PRIMARY KEY(ARTID)
GO
ALTER TABLE DETALLE ADD CONSTRAINT pkDetalle PRIMARY KEY(FOLIO, ARTID)
GO
ALTER TABLE FERRETERIAS ADD CONSTRAINT pkFerreterias PRIMARY KEY(FERRID)
GO
ALTER TABLE MUNICIPIOS ADD CONSTRAINT pkMunicipios PRIMARY KEY(MUNID)
GO
ALTER TABLE COLONIAS ADD CONSTRAINT pkColonias PRIMARY KEY(COLID)
GO
ALTER TABLE CLIENTES ADD CONSTRAINT pkClientes PRIMARY KEY(CTEID)
GO
ALTER TABLE VENTAS ADD CONSTRAINT pkVentas PRIMARY KEY(FOLIO)
GO
-- LLAVES FORANEAS
ALTER TABLE EMPLEADOS ADD
CONSTRAINT fkEmpleadosZonas FOREIGN KEY(ZONAID) REFERENCES ZONAS(ZONAID)
GO
ALTER TABLE ARTICULOS ADD
CONSTRAINT fkArticulosFamilias FOREIGN KEY(FAMID) REFERENCES FAMILIAS(FAMID)
GO
ALTER TABLE DETALLE ADD 
CONSTRAINT fkDetalleArticulos FOREIGN KEY(ARTID) REFERENCES ARTICULOS(ARTID),
CONSTRAINT fkDetalleVentas FOREIGN KEY(FOLIO) REFERENCES VENTAS(FOLIO)
GO
ALTER TABLE COLONIAS ADD 
CONSTRAINT fkColoniasMunicipios FOREIGN KEY(MUNID) REFERENCES MUNICIPIOS(MUNID)
GO
ALTER TABLE CLIENTES ADD 
CONSTRAINT fkClientesColonias FOREIGN KEY(COLID) REFERENCES COLONIAS(COLID)
GO  
ALTER TABLE VENTAS ADD 
CONSTRAINT fkVentasClientes FOREIGN KEY(CTEID) REFERENCES CLIENTES(CTEID),
CONSTRAINT fkVentasEmpleados FOREIGN KEY(EMPID) REFERENCES EMPLEADOS(EMPID),
CONSTRAINT fkVentasFerreterias FOREIGN KEY(FERRID) REFERENCES FERRETERIAS(FERRID)
GO
ALTER TABLE EMPLEADOS ADD
CONSTRAINT fkEmpleadosEmpleado FOREIGN KEY(JEFEID) REFERENCES EMPLEADOS(EMPID)
GO
--LLAVES UNICAS
ALTER TABLE CLIENTES ADD 
CONSTRAINT uc_clientes_rfc UNIQUE(CTERFC),
CONSTRAINT uc_clientes_curp UNIQUE(CTECURP)
GO
ALTER TABLE EMPLEADOS ADD 
CONSTRAINT uc_empleados_rfc UNIQUE(EMPRFC),
CONSTRAINT uc_empleados_curp UNIQUE(EMPCURP) 
GO
ALTER TABLE CLIENTES ADD 
CONSTRAINT cc_clientes_sexo CHECK(CTESEXO IN ('F', 'M')),
CONSTRAINT cc_Clientes_rfc_curp CHECK(CTERFC < CTECURP), 
CONSTRAINT cc_Clientes_rfc_len CHECK(LEN(CTERFC) = 13)
GO 
ALTER TABLE EMPLEADOS ADD 
CONSTRAINT cc_emp_rfc_curp CHECK(EMPRFC < EMPCURP)
GO
ALTER TABLE DETALLE ADD 
CONSTRAINT cc_detalle_precio CHECK(PRECIO > 0),
CONSTRAINT cc_detalle_cantidad CHECK(CANTIDAD > 0)
GO
ALTER TABLE ARTICULOS ADD 
CONSTRAINT cc_articulos_precio CHECK(ARTPRECIO > 0)
GO 
ALTER TABLE VENTAS ADD 
CONSTRAINT cc_ventas_fecha CHECK(FECHA > '1-1-2018')
GO
ALTER TABLE EMPLEADOS ADD
CONSTRAINT dc_empleados_domicilio DEFAULT ('Sin Domicilio') FOR EMPDOMICILIO,
CONSTRAINT dc_empleados_telefono DEFAULT ('Sin telefono') FOR EMPTELEFONO
GO
ALTER TABLE CLIENTES ADD
CONSTRAINT dc_clientes_domicilio DEFAULT ('Sin Domicilio') FOR CTEDOMICILIO,
CONSTRAINT dc_clientes_telefono DEFAULT ('Sin telefono') FOR CTETELEFONO 
GO 
ALTER TABLE COLONIAS ADD CONSTRAINT dc_colonias_cp DEFAULT('00000') FOR COLCP 
GO
--Insercion de datos a tablas
INSERT INTO MUNICIPIOS (MUNID, MUNNOMBRE, LADA) VALUES
(1, 'Ahome', '668'),
(2, 'Guadalajara', '33'),
(3, 'Colima', '312'),
(4, 'Tepic', '311'),
(5, 'Morelia', '443');
GO
INSERT INTO COLONIAS (COLID, COLNOMBRE, COLCP, MUNID) VALUES
(1, 'Centro', '80000', 1),
(2, 'Zapata', '60000', 2),
(3, 'Jalisco', '28000', 3),
(4, 'Guadalupana', '53000', 4),
(5, 'San Juan', '58000', 5);
GO
INSERT INTO ZONAS (ZONAID, ZONANOMBRE, ZONADESCRIPCION) VALUES
(1, 'Norte', 'Zona Norte'),
(2, 'Sur', 'Zona Sur'),
(3, 'Este', 'Zona Este'),
(4, 'Oeste', 'Zona Oeste'),
(5, 'Suereste', 'Zona Sureste');
GO
INSERT INTO FERRETERIAS (FERRID, FERRNOMBRE, FERRDOMICILIO, FERRTELEFONO) VALUES
(1, 'Ferretería El Clavo', 'Av. Juárez 123', '6679876541'),
(2, 'La Casa del Tornillo', 'Calle 5 de Febrero 456', '5552345678'),
(3, 'Todo para el Hogar', 'Paseo de la Reforma 789', '6675412638'),
(4, 'Ferretería Central', 'Avenida del Libertador 101', '6671234567'),
(5, 'Materiales y Herramientas', 'Avenida 16 de Septiembre 202', '5555678901');
GO
INSERT INTO FAMILIAS (FAMID, FAMNOMBRE, FAMDESCRIPCION) VALUES
(1, 'Herramientas', 'Herramientas manuales y eléctricas'),
(2, 'Fontanería', 'Productos de fontanería y accesorios'),
(3, 'Electrodomésticos', 'Electrodomésticos para el hogar'),
(4,'Materiales de construcción', 'Materiales para construcción y remodelación'),
(5, 'Pinturas', 'Pinturas y productos relacionados');
GO
INSERT INTO ARTICULOS (ARTID, ARTNOMBRE, ARTDESCRIPCION, ARTPRECIO, FAMID) VALUES
(1, 'Martillo', 'Martillo de acero 16oz', 150.00, 1),
(2, 'Llave Stilson', 'Llave de acero ajustable', 200.00, 2),
(3, 'Taladro', 'Taladro inalámbrico de 12V', 1800.00, 1),
(4, 'Cemento', 'Saco de cemento Portland 50kg', 120.00, 4),
(5, 'Pintura blanca', 'Pintura vinílica blanca 1L', 90.00, 5);
GO
INSERT INTO CLIENTES (CTEID, CTENOMBRE, CTEAPEPAT, CTEAPEMAT, CTEDOMICILIO, CTETELEFONO, CTECELULAR, CTERFC, CTECURP, CTEFECHANACIMIENTO, CTESEXO, COLID) VALUES
(1, 'Juan', 'Pérez', 'García', 'Calle 1 #23', '6674585417', '6674582905', 'PEPJ910101123', 'PEPJ910101HDFRRN02', '1991-01-01', 'M', 1),
(2, 'María', 'López', 'Hernández', 'Avenida 2 #34', '5551236789', '5551234567', 'LOHM920202456', 'LOHM920202MDFRRL09', '1992-02-02', 'F', 2),
(3, 'Carlos', 'Martínez', 'Sánchez', 'Calle 3 #45', '5552347890', '5552345678', 'MASJ930303789', 'MASJ930303HDFRRC03', '1993-03-03', 'M', 3),
(4, 'Ana', 'Gámez', 'Rodríguez', 'Avenida 4 #56', '6675278135', '6725689978', 'GORR940404890', 'GORR940404MDFRRL04', '1994-04-04', 'F', 4),
(5, 'Luis', 'Ramírez', 'Vega', 'Calle 5 #67', '5554569012', '5554567890', 'RAVL950505901', 'RAVL950505HDFRRN05', '1995-05-05', 'M', 5);
GO
INSERT INTO EMPLEADOS (EMPID, EMPNOMBRE, EMPAPEPAT, EMPAPEMAT, EMPDOMICILIO, EMPTELEFONO, EMPCELULAR, EMPRFC, EMPCURP, EMPFECHAINGRESO, EMPFECHANACIMIENTO, ZONAID, JEFEID) VALUES
(1, 'Pedro', 'Alvarez', 'López', 'Calle 6 #78', '5556782345', '5556786789', 'ALVP890606', 'ALVP890606HDFRRL06', '2020-06-06', '1989-06-06', 1, NULL),
(2, 'Laura', 'Fernández', 'Gámez', 'Avenida 7 #89', '5557893456', '5557897890', 'FERG870707', 'FERG870707MDFRRL07', '2019-07-07', '1987-07-07', 2, 1),
(3, 'Jorge', 'Hernández', 'Díaz', 'Calle 8 #90', '5558904567', '5558908901', 'HEDJ850808', 'HEDJ850808HDFRRN08', '2018-08-08', '1985-08-08', 3, 2),
(4, 'Sofía', 'Jiménez', 'Ramírez', 'Avenida 9 #101', '5559015678', '5559019012', 'JIRS880909', 'JIRS880909MDFRRL09', '2021-09-09', '1988-09-09', 4, 3),
(5, 'Miguel', 'Vargas', 'Pérez', 'Calle 10 #112', '5550126789', '5550120123', 'VAPM820101', 'VAPM820101HDFRRN10', '2022-10-10', '1982-10-01', 5, 4);
GO
INSERT INTO VENTAS (FOLIO, FECHA, FERRID, CTEID, EMPID) VALUES
(1, '2022-01-01', 1, 1, 1),
(2, '2022-02-02', 2, 2, 2),
(3, '2022-03-03', 3, 3, 3),
(4, '2022-04-04', 4, 4, 4),
(5, '2022-05-05', 5, 5, 5);
GO
INSERT INTO DETALLE (FOLIO, ARTID, CANTIDAD, PRECIO) VALUES
(1, 1, 2, 150.00),
(2, 2, 3, 200.00),
(3, 3, 1, 1800.00),
(4, 4, 5, 120.00),
(5, 5, 4, 90.00);
GO
SELECT*FROM VENTAS
SELECT*FROM ZONAS
SELECT*FROM CLIENTES
SELECT*FROM ARTICULOS
SELECT*FROM COLONIAS
SELECT*FROM EMPLEADOS
SELECT*FROM FAMILIAS
SELECT*FROM FERRETERIAS
SELECT*FROM MUNICIPIOS
SELECT*FROM DETALLE
GO

